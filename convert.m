inertial_info = [
    -0.0215609 0.00145914 0.14111505 0.05776087 7.331e-05 0.0014889 7.331e-05 0.0285208 -0.00075717 0.0014889 -0.00075717 0.05527734 6.93472
-0.01667657 2e-08 0.04993135 0.00151524 -2.8e-07 -0.00048566 -2.8e-07 0.00231285 -0 -0.00048566 -0 0.00149651 1.1356
-0.00431692 0.00595121 -0.00052352 0.00046475 -1.508e-05 -6.5e-07 -1.508e-05 0.00029804 2.39e-06 -6.5e-07 2.39e-06 0.00061763 0.58494148
 0.00401404 0.01530275 -0.18851723 0.03160432 -3.38e-06 0.00063965 -3.38e-06 0.03070237 0.00133966 0.00063965 0.00133966 0.00275655 2.0648
 -0.01122115 -0.00133701 -0.15252868 0.01900442 -4.75e-06 -0.0014589 -4.75e-06 0.01944097 2.008e-05 -0.0014589 2.008e-05 0.00189659 2.08123
 -0.00368911 -0.00015844 0.00129883 8.094e-05 -1.6e-07 -1.33e-06 -1.6e-07 0.00015522 -7e-08 -1.33e-06 -7e-08 0.00017313 0.26784726
 -0.00340792 1e-08 -0.04591586 0.00092215 0 0.00011963 0 0.00102289 0 0.00011963 0 0.00089314 0.72287828
-0.01667657 2e-08 0.04993135 0.00151524 -2.8e-07 -0.00048566 -2.8e-07 0.00231285 -0 -0.00048566 -0 0.00149651 1.1356
 -0.00431692 0.00595121 -0.00052352 0.00046475 -1.508e-05 -6.5e-07 -1.508e-05 0.00029804 2.39e-06 -6.5e-07 2.39e-06 0.00061763 0.58494148
 0.00400906 -0.00541624 -0.18827632 0.03174381 9.784e-05 0.00063909 9.784e-05 0.03068623 -0.00254187 0.00063909 -0.00254187 0.00291548 2.06366
-0.01122115 -0.00133701 -0.15252868 0.01900442 -4.75e-06 -0.0014589 -4.75e-06 0.01944097 2.008e-05 -0.0014589 2.008e-05 0.00189659 2.08123
 -0.00368911 -0.00015844 0.00129883 8.094e-05 -1.6e-07 -1.33e-06 -1.6e-07 0.00015522 -7e-08 -1.33e-06 -7e-08 0.00017313 0.26784726
 -0.00340792 0 -0.04591586 0.00092215 -0 0.00011963 -0 0.00102289 -0 0.00011963 -0 0.00089314 0.72287828
 -0.00442006 0.00280574 0.03664874 0.00250228 -1.572e-05 -1.986e-05 -1.572e-05 0.00266086 0.00013179 -1.986e-05 0.00013179 0.0015461 1.24072
 -0.02868847 -0.00245957 0.20400698 0.06656275 -9.681e-05 0.00599103 -9.681e-05 0.05508979 -0.00017557 0.00599103 -0.00017557 0.04262738 6.67348
 -0.01142441 0.00157484 -0.02134892 0.00061014 4.35e-06 7.329e-05 4.35e-06 0.00068918 -1.384e-05 7.329e-05 -1.384e-05 0.00040587 0.41214752
 0.00532833 -0.00053047 0.0176936 0.00069884 -7e-07 3.33e-05 -7e-07 0.00093286 -1.51e-06 3.33e-05 -1.51e-06 0.00100342 0.22297511
 0.00141599 0.04257567 0.00031503 0.00044203 -4.93e-06 -6.1e-07 -4.93e-06 0.00014181 -3.34e-06 -6.1e-07 -3.34e-06 0.00044502 0.42049079
 0.00019752 -0.00272557 -0.04191141 0.00062647 -7.3e-06 -6.476e-05 -7.3e-06 0.00071812 1.818e-05 -6.476e-05 1.818e-05 0.00029856 0.52070922
 -0.00273859 -0.00036268 -0.17426645 0.00553694 1.18e-05 -4.295e-05 1.18e-05 0.00556222 -9.379e-05 -4.295e-05 -9.379e-05 0.00071841 1.0874
-0.01222096 0.00049299 -0.07271909 0.00121955 3.9e-06 4.22e-05 3.9e-06 0.00135563 -1.497e-05 4.22e-05 -1.497e-05 0.00047041 0.6594031
 -0.00749481 9.419e-05 -0.17044123 0.00027044 -9.74e-06 1.069e-05 -9.74e-06 0.00027334 1.745e-05 1.069e-05 1.745e-05 0.00022347 0.38384092
 0.00255098 0.00162183 0.01074678 8.763e-05 1.53e-06 -3.48e-06 1.53e-06 9.159e-05 4.48e-06 -3.48e-06 4.48e-06 5.571e-05 0.25425855
 -0.00357307 -0.00756083 -0.07562434 0.00041744 -2.58e-06 -3.079e-05 -2.58e-06 0.00053272 -4.178e-05 -3.079e-05 -4.178e-05 0.00022506 0.38811052
 0.00141599 -0.04257567 -0.00031503 0.00044203 4.93e-06 6.1e-07 4.93e-06 0.00014181 -3.34e-06 6.1e-07 -3.34e-06 0.00044502 0.42049079
 0.00019752 -8.916e-05 -0.04191141 0.00063033 -6.01e-06 -6.476e-05 -6.01e-06 0.00071812 -2.895e-05 -6.476e-05 -2.895e-05 0.00030242 0.52070922
 -0.00273859 -0.00036268 -0.17426645 0.00553694 1.18e-05 -4.295e-05 1.18e-05 0.00556222 -9.379e-05 -4.295e-05 -9.379e-05 0.00071841 1.0874
 -0.01222096 0.00049299 -0.07271909 0.00121955 3.9e-06 4.22e-05 3.9e-06 0.00135563 -1.497e-05 4.22e-05 -1.497e-05 0.00047041 0.6594031
-0.00749574 -9.418e-05 -0.17044123 0.00027044 9.76e-06 1.07e-05 9.76e-06 0.00027334 -1.745e-05 1.07e-05 -1.745e-05 0.00022346 0.38384092
 -0.00255098 -0.00162183 0.01074678 8.763e-05 1.53e-06 3.48e-06 1.53e-06 9.159e-05 -4.48e-06 3.48e-06 -4.48e-06 5.571e-05 0.25425855
 -0.00241915 0.00756006 -0.07562466 0.00041745 4.71e-06 -6.41e-05 4.71e-06 0.00053559 4.177e-05 -6.41e-05 4.177e-05 0.00022792 0.38811052
];

link_names = {'body','R_HIP_Y_LINK','R_HIP_R_LINK','R_HIP_P_LINK','R_KNEE_P_LINK','R_ANKLE_P_LINK','R_ANKLE_R_LINK','L_HIP_Y_LINK','L_HIP_R_LINK', 'L_HIP_P_LINK','L_KNEE_P_LINK',...
    'L_ANKLE_P_LINK','L_ANKLE_R_LINK','CHEST_P_LINK', 'torso','NECK_Y_LINK','NECK_P_LINK','R_SHOULDER_P_LINK','R_SHOULDER_R_LINK','R_SHOULDER_Y_LINK','R_ELBOW_P_LINK',...
    'R_WRIST_Y_LINK','R_WRIST_P_LINK','r_wrist', 'L_SHOULDER_P_LINK', 'L_SHOULDER_R_LINK', 'L_SHOULDER_Y_LINK', 'L_ELBOW_P_LINK', 'L_WRIST_Y_LINK', 'L_WRIST_P_LINK', 'l_wrist'}; 

r_ankle = [0.01130279 -0.01139641 -0.07868422 0.00121526 8.51e-06 2.787e-05 8.51e-06 0.00254705 -2.1e-06 2.787e-05 -2.1e-06 0.00362666 0.57831553];
l_ankle = [ 0.01130279 0.01139641 -0.07868422 0.00121526 -8.51e-06 2.787e-05 -8.51e-06 0.00254705 2.1e-06 2.787e-05 2.1e-06 0.00362666 0.57831553];

Rotation = [
    1 0 0  0 1 0  0 0 1 % identity
    
    0 1 0  -1 0 0  0 0 1
    0 1 0  0 0 1  1 0 0
    0 0 1  1 0 0  0 1 0
    0 0 1  1 0 0  0 1 0
    0 0 1  1 0 0  0 1 0
    0 0 1  0 -1 0  1 0 0
    
    0 1 0  -1 0 0  0 0 1
    0 1 0  0 0 1  1 0 0
    0 0 1  1 0 0  0 1 0
    0 0 1  1 0 0  0 1 0
    0 0 1  1 0 0  0 1 0
    0 0 1  0 -1 0  1 0 0
    
    1 0 0  0 0 -1  0 1 0
     1 0 0  0 1 0  0 0 1 % identity
     1 0 0  0 1 0  0 0 1 % identity
    1 0 0  0 0 -1  0 1 0
    
    1 0 0  0 0 -1  0 1 0
    0 0 -1  0 1 0  1 0 0
    0 -1 0  1 0 0  0 0 1
    1 0 0  0 0 -1  0 1 0
    1 0 0  0 1 0  0 0 1  % identity
    1 0 0  0 0 -1  0 1 0
    0 0 -1  0 1 0  1 0 0
    
    1 0 0  0 0 -1  0 1 0
    0 0 -1  0 1 0  1 0 0
    0 -1 0  1 0 0  0 0 1
    1 0 0  0 0 -1  0 1 0
    1 0 0  0 1 0  0 0 1  % identity
    1 0 0  0 0 -1  0 1 0
    0 0 -1  0 1 0  1 0 0
];


for i = 1:length(inertial_info)
    com_pos = inertial_info(i,1:3);
    Icom = reshape(inertial_info(i,4:12),3,3)';  % reshape goes columnwise
    m = inertial_info(i,13);
    R = reshape(Rotation(i,:),3,3)';
    I = Icom + m*cr3(com_pos)*cr3(com_pos)';
    I = R*I*R';
    c = R*com_pos';
    
    % R(L)_ANKLE_R_LINK and r(l)ankle link are lumped together, since the connecting joint is fixed.  
    if strcmp(link_names(i), 'R_ANKLE_R_LINK')
         m1 = r_ankle(13);
         com_pos1 = r_ankle(1:3);
         Icom1 = reshape(r_ankle(4:12),3,3)'; 
         I1 = Icom1 + m*cr3(com_pos1)*cr3(com_pos1)';
         I1 = R*I1*R';
         c1 = R*com_pos1';
         
         c = (c1*m1 + c*m)/(m1+m);
         I = I + I1;
         m = m + m1;
         fprintf('\nR_ANKLE_R_LINK and r_ankle lumped!\n\n');
    else if strcmp(link_names(i), 'L_ANKLE_R_LINK')
             m2 = l_ankle(13);
             com_pos2 = l_ankle(1:3);
             Icom2 = reshape(l_ankle(4:12),3,3)'; 
             I2 = Icom2 + m*cr3(com_pos2)*cr3(com_pos2)';
             I2 = R*I2*R';
             c2 = R*com_pos2';
         
             c = (c2*m2 + c*m)/(m2+m);
             I = I + I2;
             m = m + m2;
             fprintf('\nL_ANKLE_R_LINK and l_ankle lumped!\n\n');
        end
        
    end
    
    link_names(i)
    fprintf('    Inertia     %10.8f %10.8f %10.8f \n                %10.8f %10.8f %10.8f \n                %10.8f %10.8f %10.8f\n\n',I(1,1), I(1,2),I(1,3),I(2,1),I(2,2),I(2,3),I(3,1),I(3,2),I(3,3));
    fprintf('    Center_of_Gravity    %10.8f %10.8f %10.8f\n\n', c(1), c(2), c(3));
    fprintf('    mass = \n\n %10.8f\n\n\n\n\n\n', m);
end


% contact points
cp=[
 0.127 0.058 -0.093
-0.097 0.058   -0.093 
-0.097 -0.038  -0.093  
0.127 -0.038  -0.093 ]; % counter clock wise 
    

Rot = [0 0 1 
       0 -1 0  
       1 0 0];
  
contact_p =(Rot*cp')';
contact_p

    
    
    
    
    
    
    
    